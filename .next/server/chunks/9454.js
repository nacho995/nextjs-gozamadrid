"use strict";exports.id=9454,exports.ids=[9454],exports.modules={11993:(e,t,o)=>{o.d(t,{dZ:()=>c,g6:()=>i});var r=o(33039);let a=parseInt(process.env.NEXT_PUBLIC_API_TIMEOUT||"60000"),s=parseInt(process.env.NEXT_PUBLIC_MAX_RETRIES||"5"),l=async(e,t={},o=a)=>{let r=new AbortController,s=setTimeout(()=>r.abort(),o);try{let o=await fetch(e,{...t,signal:r.signal,headers:{Accept:"application/json","Cache-Control":"no-cache","User-Agent":"GozaMadrid-Frontend/1.0",...t.headers||{}}});return clearTimeout(s),o}catch(t){if(clearTimeout(s),"AbortError"===t.name)throw Error(`La petici\xf3n a ${e} excedi\xf3 el tiempo l\xedmite de ${o}ms`);throw t}},n=async(e,t={},o=s)=>{let r,a=1e3;for(let s=0;s<o;s++)try{console.log(`Intento ${s+1} de ${o} para ${e}`);let r=await l(e,t);if(!r.ok)throw Error(`HTTP error! status: ${r.status}`);let a=await r.json();return console.log(`Petici\xf3n exitosa a ${e}`),a}catch(t){console.error(`Intento ${s+1} fallido para ${e}:`,t),r=t,s<o-1&&(console.log(`Esperando ${a}ms antes del siguiente intento...`),await new Promise(e=>setTimeout(e,a)),a=Math.min(2*a,1e4))}throw console.error(`Todos los intentos fallaron para ${e}`),r},i=async()=>{try{return await n(`${r.A.WP_API_URL}/posts`)}catch(e){throw console.error("Error al obtener posts del blog:",e),e}},c=async e=>{try{return await n(`/api/proxy/blog-by-id?id=${encodeURIComponent(e)}`)}catch(e){throw console.error("Error al obtener post del blog:",e),e}}},45001:(e,t,o)=>{o.d(t,{A:()=>d});var r=o(8732),a=o(82015);o(38713);var s=o(49788),l=o.n(s);process.env.NEXT_PUBLIC_API_URL;let n=["https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&h=600&fit=crop&q=80","https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=800&h=600&fit=crop&q=80","https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=800&h=600&fit=crop&q=80"],i=e=>!e||"string"!=typeof e||e.includes("via.placeholder.com")||e.includes("placeholder.com")||e.includes("example.com")?null:(e.includes("wordpress.realestategozamadrid.com")&&(e=e.replace("wordpress.realestategozamadrid.com","www.realestategozamadrid.com")),e.startsWith("http:")&&(e=e.replace("http:","https:")),e),c=e=>{let t=i(e);if(!t)return null;if(t.includes("unsplash.com")||t.includes("images.unsplash.com"))return t;if(t.includes("realestategozamadrid.com")&&t.includes("wp-content"))return`/api/proxy-image?url=${encodeURIComponent(t)}`;try{return`https://images.weserv.nl/?url=${encodeURIComponent(t)}&w=800&h=600&fit=cover&default=${encodeURIComponent(n[0])}`}catch(e){return console.error("[BlogImage] Error creando proxy URL:",e),null}},d=({src:e,alt:t,className:o="",priority:s=!1,sizes:d="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw",fallbackSrc:p})=>{let[g,h]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[f,w]=(0,a.useState)(!0),y=(0,a.useRef)(null),[b,I]=(0,a.useState)({width:800,height:600}),[A,P]=(0,a.useState)({original:null,processed:null}),[x,$]=(0,a.useState)(""),[j,E]=(0,a.useState)(0);(0,a.useEffect)(()=>{h(!0)},[]);let S=(0,a.useCallback)(e=>{if(p){let e=i(p);if(e)return e}let t=c(e);return t||n[0]},[p]);(0,a.useEffect)(()=>{h(!0),$(S(e))},[e,S]);let _=(0,a.useCallback)(()=>{if(console.error(`Error cargando imagen: ${x}, usando fallback`),u(!0),j<n.length-1){let e=j+1;E(e),$(n[e]),u(!1)}else $(n[n.length-1])},[x,j]),v=(0,a.useCallback)(()=>{w(!1),u(!1)},[]),C=`blog-image-${Math.random().toString(36).substring(2,9)}`,U={"@context":"https://schema.org","@type":"ImageObject","@id":`#${C}`,contentUrl:x,name:t||"Imagen del blog",description:t||"Fotograf\xeda del blog",representativeOfPage:s};return g?m||!x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({...U,contentUrl:n[j]})}})}),(0,r.jsxs)("div",{className:`flex items-center justify-center bg-gray-200 ${o}`,ref:y,itemScope:!0,itemType:"https://schema.org/ImageObject","aria-label":"Imagen no disponible",role:"img",itemID:`#${C}`,children:[(0,r.jsx)("img",{src:n[j],alt:t||"Imagen no disponible",className:"object-cover w-full h-full"}),(0,r.jsx)("meta",{itemProp:"contentUrl",content:n[j]}),(0,r.jsx)("meta",{itemProp:"name",content:t||"Imagen no disponible"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(U)}})}),(0,r.jsxs)("div",{ref:y,className:"relative overflow-hidden",itemScope:!0,itemType:"https://schema.org/ImageObject",itemID:`#${C}`,children:[f&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:(0,r.jsx)("div",{className:"animate-pulse bg-gray-200 rounded-full h-16 w-16"})}),(0,r.jsx)("img",{src:x,alt:t||"Imagen del blog",className:`w-full h-full object-cover ${o}`,onError:_,onLoad:v,loading:s?"eager":"lazy",decoding:"async",itemProp:"contentUrl","data-debug":JSON.stringify(A)}),(0,r.jsx)("meta",{itemProp:"name",content:t||"Fotograf\xeda del blog"}),(0,r.jsx)("meta",{itemProp:"representativeOfPage",content:s?"true":"false"})]})]}):null}},98110:(e,t,o)=>{o.d(t,{XL:()=>n}),o(33039),process.env.NEXT_PUBLIC_WP_API_URL;let r=process.env.NEXT_PUBLIC_WP_PROXY_URL||"https://www.realestategozamadrid.com/api/wordpress-proxy";process.env.WORDPRESS_API_URL;let a=e=>null==e?"":"string"==typeof e?e:"number"==typeof e||"boolean"==typeof e?String(e):"object"==typeof e?e.rendered?e.rendered:JSON.stringify(e):String(e);class s{constructor(){this.cache=new Map,this.cacheExpiry=3e5,this.retryAttempts=3,this.retryDelay=1e3}async withRetry(e,t=this.retryAttempts){let o;for(let r=1;r<=t;r++)try{return await e()}catch(a){if(o=a,r===t)throw a;let e=this.retryDelay*Math.pow(2,r-1);console.log(`[BlogAPI] Retry ${r}/${t} en ${e}ms...`),await this.sleep(e)}throw o}async sleep(e){return new Promise(t=>setTimeout(t,e))}getCached(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>this.cacheExpiry?(this.cache.delete(e),null):t.data:null}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}async getBlogPosts(e=10){let t=`blogs-${e}`,o=this.getCached(t);if(o)return console.log("[BlogAPI] ✅ Datos desde cache"),o;console.log("[BlogAPI] \uD83D\uDD04 Iniciando obtenci\xf3n de blogs...");try{let e=await this.withRetry(async()=>{let e=await fetch("/api/wordpress-proxy",{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-BlogAPI/2.0","Cache-Control":"no-cache"},signal:AbortSignal.timeout(15e3)});if(!e.ok)throw Error(`WordPress API failed: ${e.status}`);let t=await e.json();if(!Array.isArray(t)||0===t.length)throw Error("WordPress returned empty data");return t});if(e&&e.length>0){console.log(`[BlogAPI] ✅ WordPress exitoso: ${e.length} blogs`);let o={posts:e,source:"wordpress"};return this.setCache(t,o),o}}catch(e){console.log(`[BlogAPI] ⚠️ WordPress fall\xf3: ${e.message}`)}try{let o=await this.withRetry(async()=>{let e=await fetch("https://gw.estateinsight.zone/api/estates/blogs?limit=100",{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-BlogAPI/2.0","X-API-Key":process.env.AWS_API_KEY||""},signal:AbortSignal.timeout(12e3)});if(!e.ok)throw Error(`AWS API failed: ${e.status}`);let t=await e.json();if(!t.success||!Array.isArray(t.data)||0===t.data.length)throw Error("AWS returned invalid data");return t.data});if(o&&o.length>0){console.log(`[BlogAPI] ✅ AWS exitoso: ${o.length} blogs`);let r={posts:o.slice(0,e).map(e=>({id:e.id||Math.random().toString(36).substr(2,9),title:{rendered:e.title||"Sin t\xedtulo"},excerpt:{rendered:e.description||""},content:{rendered:e.content||""},date:e.date||new Date().toISOString(),slug:e.slug||"blog-post",featured_media:0,featured_image_url:e.image?.src||"https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&h=600&fit=crop&q=80",author_name:e.author||"Equipo Goza Madrid",source:"aws"})),source:"aws"};return this.setCache(t,r),r}}catch(e){console.log(`[BlogAPI] ⚠️ AWS fall\xf3: ${e.message}`)}try{let o=await fetch("/api/blogs-backup",{method:"GET",headers:{Accept:"application/json"}});if(o.ok){let r=await o.json();if(Array.isArray(r)&&r.length>0){console.log(`[BlogAPI] ✅ Respaldo exitoso: ${r.length} blogs`);let o={posts:r.slice(0,e),source:"backup"};return this.setCache(t,o),o}}}catch(e){console.error(`[BlogAPI] ❌ Respaldo fall\xf3: ${e.message}`)}return console.log("[BlogAPI] \uD83C\uDD98 Usando blogs hardcoded como \xfaltimo recurso"),{posts:[{id:"fallback-1",title:{rendered:"Bienvenido a Goza Madrid"},excerpt:{rendered:"Estamos preparando contenido incre\xedble para ti."},content:{rendered:"<p>Muy pronto tendr\xe1s acceso a nuestros blogs sobre el mercado inmobiliario en Madrid.</p>"},date:new Date().toISOString(),slug:"bienvenido-goza-madrid",featured_image_url:"https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&h=600&fit=crop&q=80",author_name:"Equipo Goza Madrid",source:"fallback"}],source:"fallback"}}clearCache(){this.cache.clear(),console.log("[BlogAPI] Cache limpiado")}}let l=new s;async function n(e=1,t=10){try{return await l.getBlogPosts(t)}catch(e){return console.error("[BlogAPI] Error fatal:",e),{posts:[],source:"error",error:e.message}}}}};