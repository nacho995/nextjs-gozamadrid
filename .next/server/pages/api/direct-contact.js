"use strict";(()=>{var e={};e.id=7543,e.ids=[7543],e.modules={8667:(e,o)=>{Object.defineProperty(o,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},21572:e=>{e.exports=require("nodemailer")},33480:(e,o,t)=>{e.exports=t(75600)},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},76305:(e,o,t)=>{t.r(o),t.d(o,{config:()=>m,default:()=>d,routeModule:()=>p});var a={};t.r(a),t.d(a,{default:()=>l});var r=t(33480),n=t(8667),i=t(86435),s=t(21572),c=t.n(s);async function l(e,o){if(o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Methods","POST, OPTIONS"),o.setHeader("Access-Control-Allow-Headers","Content-Type"),"OPTIONS"===e.method)return o.status(200).end();if("POST"!==e.method)return o.status(405).json({error:"M\xe9todo no permitido"});console.log("[Direct Contact] Datos recibidos:",e.body?Object.keys(e.body):"Sin datos");try{console.log("[Direct Contact] Recibida solicitud:",e.body);let{name:a,nombre:r,email:n,phone:i,telefono:s,prefix:l,message:d,mensaje:m,asunto:p}=e.body,u={nombre:r||a||"Sin nombre",email:n||"correo@nodisponible.com",telefono:s||i||"No proporcionado",prefix:l||"+34",mensaje:m||d||"Sin mensaje",asunto:p||"Formulario de contacto web"};if(!u.nombre||!u.email)return o.status(400).json({error:"Nombre y email son obligatorios"});let g=`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #e0e0e0; border-radius: 5px;">
        <div style="background-color: #000; padding: 15px; text-align: center; border-radius: 5px 5px 0 0;">
          <h1 style="color: #D4AF37; margin: 0; font-size: 24px;">Nuevo Mensaje de Contacto</h1>
        </div>
        <div style="padding: 20px; background-color: #f9f9f9;">
          <p style="margin-bottom: 15px; font-size: 16px;"><strong>Nombre:</strong> ${u.nombre}</p>
          <p style="margin-bottom: 15px; font-size: 16px;"><strong>Email:</strong> ${u.email}</p>
          <p style="margin-bottom: 15px; font-size: 16px;"><strong>Tel\xe9fono:</strong> ${u.prefix} ${u.telefono}</p>
          <div style="background-color: #fff; padding: 15px; border-left: 4px solid #D4AF37; margin-bottom: 15px;">
            <p style="margin: 0; font-size: 16px;"><strong>Mensaje:</strong></p>
            <p style="margin: 10px 0 0; font-size: 16px;">${u.mensaje}</p>
          </div>
        </div>
        <div style="background-color: #000; color: #fff; text-align: center; padding: 10px; border-radius: 0 0 5px 5px;">
          <p style="margin: 0; font-size: 14px;">Goza Madrid - Mensaje desde la Web</p>
        </div>
      </div>
    `,f=[];try{var t;let e=c().createTransport({host:"smtp.gmail.com",port:587,secure:!1,auth:{user:"ignaciodalesiolopez@gmail.com",pass:"tjlt deip zhwe mkzm"},tls:{rejectUnauthorized:!1}}),o={from:'"Formulario Goza Madrid" <ignaciodalesiolopez@gmail.com>',to:"marta@gozamadrid.com, ignaciodalesio1995@gmail.com",subject:`Nuevo mensaje de contacto de ${u.nombre}`,html:g,text:(t=u,`
Datos del formulario de contacto:

Nombre: ${t.nombre||"No proporcionado"}
Email: ${t.email||"No proporcionado"}
Tel\xe9fono: ${t.prefix||"+34"} ${t.telefono||"No proporcionado"}
Mensaje: ${t.mensaje||"No proporcionado"}
  `),replyTo:u.email};f.push(new Promise((t,a)=>{e.sendMail(o,(e,o)=>{e?(console.error("[Direct Contact] Error Nodemailer:",e),a(e)):(console.log("[Direct Contact] Email enviado via Nodemailer:",o.messageId),t(o))})})),console.log("[Direct Contact] Agregado env\xedo por Nodemailer")}catch(e){console.error("[Direct Contact] Error configurando Nodemailer:",e)}f.push(fetch("https://formsubmit.co/ajax/655e72bc841f663154fb80111510aa54",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:u.nombre,email:u.email,_subject:`Nuevo mensaje de contacto de ${u.nombre}`,_template:"box",message:g,_captcha:"false"})})),f.push(fetch("https://formsubmit.co/ajax/ignaciodalesio1995@gmail.com",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:u.nombre,email:u.email,_subject:`Nuevo mensaje de contacto de ${u.nombre}`,_template:"box",message:g,_captcha:"false"})}));try{f.push(fetch("https://gozamadrid-api-prod.eba-adypnjgx.eu-west-3.elasticbeanstalk.com/api/contact",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({nombre:u.nombre,email:u.email,telefono:u.telefono,prefix:u.prefix,mensaje:u.mensaje,asunto:u.asunto,ccEmail:"ignaciodalesio1995@gmail.com,marta@gozamadrid.com"})})),f.push(fetch("http://gozamadrid-api-prod.eba-adypnjgx.eu-west-3.elasticbeanstalk.com/api/contact",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({nombre:u.nombre,email:u.email,telefono:u.telefono,prefix:u.prefix,mensaje:u.mensaje,asunto:u.asunto,ccEmail:"ignaciodalesio1995@gmail.com,marta@gozamadrid.com"})})),console.log("[Direct Contact] Agregados intentos de backend (HTTP y HTTPS)")}catch(e){console.error("[Direct Contact] Error preparando env\xedo al backend (ignorado):",e)}try{f.push(fetch("https://api.emailjs.com/api/v1.0/email/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:"service_qqnhk07",template_id:"template_ljhtvus",user_id:"OmMNBfZJiSdYY5HwO",template_params:{from_name:u.nombre,reply_to:u.email,message:u.mensaje,phone:`${u.prefix} ${u.telefono}`,to_email:"marta@gozamadrid.com,ignaciodalesio1995@gmail.com"}})})),console.log("[Direct Contact] Agregado env\xedo por Email.js")}catch(e){console.error("[Direct Contact] Error preparando Email.js (ignorado):",e)}let b=new Promise((e,o)=>setTimeout(()=>o(Error("Timeout")),15e3)),h=Promise.allSettled(f),x=await Promise.race([h,b.then(()=>(console.log("[Direct Contact] Timeout alcanzado, continuando con los resultados disponibles"),Promise.allSettled(f)))]),j=x.filter(e=>"fulfilled"===e.status&&(!e.value.status||e.value.status<400||e.value.ok)).length;if(console.log(`[Direct Contact] M\xe9todos de env\xedo exitosos: ${j} de ${f.length}`),j>0)return o.status(200).json({success:!0,message:`Mensaje enviado correctamente por ${j} v\xedas`,delivered:j,timestamp:new Date().toISOString()});{let e=x.filter(e=>"rejected"===e.status).map(e=>e.reason);return console.error("[Direct Contact] Errores al enviar:",e),o.status(200).json({success:!0,message:"Tu mensaje ha sido procesado",note:"Si no recibes respuesta pronto, por favor cont\xe1ctanos directamente por tel\xe9fono",timestamp:new Date().toISOString()})}}catch(e){return console.error("[Direct Contact] Error general:",e),o.status(200).json({success:!0,message:"Tu mensaje ha sido procesado",note:"Si no recibes respuesta pronto, por favor cont\xe1ctanos directamente por tel\xe9fono",timestamp:new Date().toISOString()})}}let d=(0,i.M)(a,"default"),m=(0,i.M)(a,"config"),p=new r.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/direct-contact",pathname:"/api/direct-contact",bundlePath:"",filename:""},userland:a})},86435:(e,o)=>{Object.defineProperty(o,"M",{enumerable:!0,get:function(){return function e(o,t){return t in o?o[t]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,t)):"function"==typeof o&&"default"===t?o:void 0}}})}};var o=require("../../webpack-api-runtime.js");o.C(e);var t=o(o.s=76305);module.exports=t})();