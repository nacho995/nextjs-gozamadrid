"use strict";(()=>{var e={};e.id=7034,e.ids=[7034],e.modules={8667:(e,o)=>{Object.defineProperty(o,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,o,t)=>{e.exports=t(75600)},68134:(e,o,t)=>{t.r(o),t.d(o,{config:()=>d,default:()=>i,routeModule:()=>g});var r={};t.r(r),t.d(r,{default:()=>l});var s=t(33480),a=t(8667),n=t(86435);async function l(e,o){if(o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Methods","GET, OPTIONS"),o.setHeader("Access-Control-Allow-Headers","Content-Type, Accept"),"OPTIONS"===e.method)return o.status(200).end();if("GET"!==e.method)return o.status(405).json({error:"M\xe9todo no permitido"});try{console.log("[Blogs API] Iniciando obtenci\xf3n de blogs...");try{console.log("[Blogs API] Intentando WordPress via proxy...");let t=await fetch(`${e.headers.origin||"https://www.realestategozamadrid.com"}/api/wordpress-proxy`,{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-BlogAPI/1.0"},signal:AbortSignal.timeout(1e4)});if(t.ok){let e=await t.json();if(Array.isArray(e)&&e.length>0)return console.log(`[Blogs API] ✅ WordPress exitoso: ${e.length} blogs`),o.setHeader("Cache-Control","public, max-age=300, s-maxage=600"),o.setHeader("X-Source","wordpress-proxy"),o.setHeader("X-Posts-Count",e.length.toString()),o.status(200).json(e)}console.log("[Blogs API] WordPress proxy fall\xf3 o sin datos")}catch(e){console.log("[Blogs API] Error WordPress proxy:",e.message)}try{console.log("[Blogs API] Intentando backend AWS...");let e=await fetch("https://gw.estateinsight.zone/api/estates/blogs?limit=100",{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-API/1.0","X-API-Key":process.env.AWS_API_KEY||""},signal:AbortSignal.timeout(8e3)});if(e.ok){let t=await e.json();if(t.success&&Array.isArray(t.data)&&t.data.length>0){console.log(`[Blogs API] ✅ AWS exitoso: ${t.data.length} blogs`);let e=t.data.map(e=>({id:e.id||Math.random().toString(36).substr(2,9),title:{rendered:e.title||"Sin t\xedtulo"},excerpt:{rendered:e.description||""},content:{rendered:e.content||""},date:e.date||new Date().toISOString(),slug:e.slug||"blog-post",featured_media:0,featured_image_url:e.image?.src||null,author_name:e.author||"Equipo Goza Madrid",source:"aws",_embedded:e._embedded||{}}));return o.setHeader("Cache-Control","public, max-age=300, s-maxage=600"),o.setHeader("X-Source","aws-backend"),o.setHeader("X-Posts-Count",e.length.toString()),o.status(200).json(e)}}console.log("[Blogs API] Backend AWS fall\xf3 o sin datos")}catch(e){console.log("[Blogs API] Error backend AWS:",e.message)}try{console.log("[Blogs API] Usando endpoint de respaldo...");let t=await fetch(`${e.headers.origin||"https://www.realestategozamadrid.com"}/api/blogs-backup`,{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-BlogAPI/1.0"}});if(t.ok){let e=await t.json();if(Array.isArray(e)&&e.length>0)return console.log(`[Blogs API] ✅ Respaldo exitoso: ${e.length} blogs`),o.setHeader("Cache-Control","public, max-age=300, s-maxage=600"),o.setHeader("X-Source","backup-endpoint"),o.setHeader("X-Posts-Count",e.length.toString()),o.status(200).json(e)}console.log("[Blogs API] Endpoint de respaldo fall\xf3")}catch(e){console.log("[Blogs API] Error endpoint respaldo:",e.message)}return console.error("[Blogs API] ❌ Todas las fuentes fallaron"),o.status(500).json({error:"No se obtuvieron blogs de ninguna fuente",details:"WordPress, AWS y endpoint de respaldo no disponibles",timestamp:new Date().toISOString()})}catch(e){return console.error("[Blogs API] Error general:",e.message),o.status(500).json({error:"Error interno del servidor",details:e.message})}}let i=(0,n.M)(r,"default"),d=(0,n.M)(r,"config"),g=new s.PagesAPIRouteModule({definition:{kind:a.A.PAGES_API,page:"/api/blogs",pathname:"/api/blogs",bundlePath:"",filename:""},userland:r})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,o)=>{Object.defineProperty(o,"M",{enumerable:!0,get:function(){return function e(o,t){return t in o?o[t]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,t)):"function"==typeof o&&"default"===t?o:void 0}}})}};var o=require("../../webpack-api-runtime.js");o.C(e);var t=o(o.s=68134);module.exports=t})();