"use strict";(()=>{var e={};e.id=7526,e.ids=[7526],e.modules={8667:(e,o)=>{Object.defineProperty(o,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,o,t)=>{e.exports=t(75600)},61893:(e,o,t)=>{t.r(o),t.d(o,{config:()=>d,default:()=>c,routeModule:()=>l});var a={};t.r(a),t.d(a,{default:()=>s});var r=t(33480),n=t(8667),i=t(86435);async function s(e,o){if(o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Methods","GET, POST, OPTIONS"),o.setHeader("Access-Control-Allow-Headers","Content-Type, X-Requested-With"),"OPTIONS"===e.method)return o.status(200).end();if("GET"!==e.method&&"POST"!==e.method)return o.status(405).json({error:"M\xe9todo no permitido"});try{let{path:t,...a}=e.query,r=`http://gozamadrid-api-prod.eba-adypnjgx.eu-west-3.elasticbeanstalk.com${t?`/${t}`:""}`;if(Object.keys(a).length>0){let e=new URLSearchParams;for(let[o,t]of Object.entries(a))"path"!==o&&e.append(o,t);r+=`?${e.toString()}`}console.log(`[Proxy] Redirigiendo solicitud a: ${r}`);let n={method:e.method,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","User-Agent":"GozaMadrid-Frontend/1.0"}};if(e.body&&Object.keys(e.body).length>0){let o={...e.body};"api/contact"===t?(o.ccEmail="ignaciodalesio1995@gmail.com,marta@gozamadrid.com",o.name&&!o.nombre&&(o.nombre=o.name),o.message&&!o.mensaje&&(o.mensaje=o.message),o.asunto||(o.asunto="Formulario de contacto web"),o.phone&&!o.telefono&&(o.telefono=o.phone),console.log("[Proxy] Datos de contacto modificados:",o)):"api/property-visit/create"===t?(o.ccEmail="ignaciodalesio1995@gmail.com,marta@gozamadrid.com",console.log("[Proxy] A\xf1adidos ambos emails en copia para visita:",o)):"api/property-offer/create"===t&&(o.ccEmail="ignaciodalesio1995@gmail.com,marta@gozamadrid.com",o.offerAmount&&!o.offerPrice&&(o.offerPrice=o.offerAmount,console.log("[Proxy] Convertido offerAmount a offerPrice para compatibilidad")),console.log("[Proxy] A\xf1adido email adicional en copia para oferta:",o)),n.body=JSON.stringify(o)}console.log("[Proxy] Opciones de fetch:",{method:n.method,headers:n.headers,body:n.body?JSON.parse(n.body):null});let i=new AbortController;n.signal=i.signal;let s=setTimeout(()=>i.abort(),3e4);try{let e,t=await fetch(r,n);clearTimeout(s);let a=t.headers.get("content-type");return e=a&&a.includes("application/json")?await t.json():await t.text(),console.log("[Proxy] Respuesta del backend:",{status:t.status,headers:Object.fromEntries([...t.headers.entries()]),data:e}),o.status(t.status).json(e)}catch(a){if(console.error("[Proxy] Error en la petici\xf3n fetch:",a.message),clearTimeout(s),"api/contact"===t&&e.body)try{console.log("[Proxy] Intentando enviar v\xeda FormSubmit como alternativa");let t={name:e.body.nombre||e.body.name||"Cliente",email:e.body.email||"contacto@gozamadrid.com",_subject:`Nuevo mensaje de contacto (v\xeda proxy)`,message:`
              Nombre: ${e.body.nombre||e.body.name||"No especificado"}

              Email: ${e.body.email||"No especificado"}

              Tel\xe9fono: ${e.body.prefix||"+34"} ${e.body.telefono||e.body.phone||"No especificado"}

              Mensaje: ${e.body.mensaje||e.body.message||"No hay mensaje"}
            `,_template:"box",_captcha:"false"};if((await fetch("https://formsubmit.co/ajax/655e72bc841f663154fb80111510aa54",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)})).ok)return console.log("[Proxy] Env\xedo v\xeda FormSubmit exitoso"),o.status(200).json({success:!0,message:"Mensaje enviado v\xeda FormSubmit como alternativa",source:"formsubmit"})}catch(e){console.error("[Proxy] Error al usar FormSubmit:",e)}return o.status(500).json({error:"Error en la comunicaci\xf3n con el backend",message:a.message})}}catch(e){console.error("[Proxy] Error general:",e),o.status(500).json({error:"Error en el proxy",message:e.message})}}let c=(0,i.M)(a,"default"),d=(0,i.M)(a,"config"),l=new r.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/api-proxy",pathname:"/api/api-proxy",bundlePath:"",filename:""},userland:a})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,o)=>{Object.defineProperty(o,"M",{enumerable:!0,get:function(){return function e(o,t){return t in o?o[t]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,t)):"function"==typeof o&&"default"===t?o:void 0}}})}};var o=require("../../webpack-api-runtime.js");o.C(e);var t=o(o.s=61893);module.exports=t})();