"use strict";(()=>{var e={};e.id=2620,e.ids=[2620],e.modules={1428:e=>{e.exports=import("axios")},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},14815:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>a});var o=r(1428),n=e([o]);async function a(e,t){if(t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, POST, OPTIONS"),t.setHeader("Access-Control-Allow-Headers","Content-Type"),"OPTIONS"===e.method)return t.status(200).end();if("GET"!==e.method&&"POST"!==e.method)return t.status(405).json({error:"M\xe9todo no permitido",message:"Solo se permiten solicitudes GET y POST"});try{let r,{url:s,source:n,path:a,limit:i=100}=e.query,u={mongodb:process.env.NEXT_PUBLIC_API_MONGODB_URL||"https://gozamadrid-api-prod.eba-adypnjgx.eu-west-3.elasticbeanstalk.com",woocommerce:"https://wordpress.realestategozamadrid.com/wp-json/wc/v3",wordpress:"https://wordpress.realestategozamadrid.com/wp-json/wp/v2"};if(s)r=s;else{if(!n||!a)return t.status(400).json({error:"Par\xe1metros insuficientes",message:'Debe proporcionar una URL completa con el par\xe1metro "url", o un "source" y un "path"'});let e=u[n.toLowerCase()];if(!e)return t.status(400).json({error:"Fuente inv\xe1lida",message:`La fuente "${n}" no est\xe1 soportada. Use una de: ${Object.keys(u).join(", ")}`});let s=a.startsWith("/")?a:`/${a}`;if(r=`${e}${s}`,"woocommerce"===n.toLowerCase()){if(r+=r.includes("?")?"&":"?",!process.env.WC_CONSUMER_KEY||!process.env.WC_CONSUMER_SECRET)return t.status(500).json({error:"Credenciales de WooCommerce no configuradas"});r+=`consumer_key=${process.env.WC_CONSUMER_KEY}&consumer_secret=${process.env.WC_CONSUMER_SECRET}`}}!i||r.includes("limit=")||r.includes("per_page=")||((r+=r.includes("?")?"&":"?").includes("woocommerce")||r.includes("wp/v2")?r+=`per_page=${i}`:r+=`limit=${i}`),console.log(`[API Proxy] Redirigiendo solicitud a: ${r}`);let d=await (0,o.default)({method:e.method,url:r,headers:{Accept:"application/json","Content-Type":"application/json"},data:"POST"===e.method?e.body:void 0,timeout:1e4});return t.status(d.status).json(d.data)}catch(e){if(console.error("[API Proxy] Error:",e.message),e.response)return t.status(e.response.status).json({error:"Error en la API externa",status:e.response.status,message:e.message,data:e.response.data});if(e.request)return t.status(504).json({error:"Sin respuesta de la API externa",message:"La API externa no respondi\xf3 a tiempo",details:e.message});return t.status(500).json({error:"Error interno del proxy",message:e.message})}}o=(n.then?(await n)():n)[0],s()}catch(e){s(e)}})},33480:(e,t,r)=>{e.exports=r(75600)},63772:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>c,default:()=>d,routeModule:()=>p});var o=r(33480),n=r(8667),a=r(86435),i=r(14815),u=e([i]);i=(u.then?(await u)():u)[0];let d=(0,a.M)(i,"default"),c=(0,a.M)(i,"config"),p=new o.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/proxy-new",pathname:"/api/proxy-new",bundlePath:"",filename:""},userland:i});s()}catch(e){s(e)}})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=63772);module.exports=r})();