"use strict";(()=>{var e={};e.id=7311,e.ids=[7311],e.modules={8667:(e,o)=>{Object.defineProperty(o,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,o,r)=>{e.exports=r(75600)},58341:(e,o,r)=>{r.r(o),r.d(o,{config:()=>d,default:()=>l,routeModule:()=>u});var t={};r.r(t),r.d(t,{default:()=>c});var n=r(33480),a=r(8667),s=r(86435);async function i(e,o={},r=2e3){try{console.log(`[API Config] Verificando disponibilidad de: ${e}`);let t=o&&Object.keys(o).length>0?`${e}?${new URLSearchParams(o).toString()}`:e,n=await fetch(t+"?limit=1",{method:"GET",signal:AbortSignal.timeout(r),headers:{Accept:"application/json","Cache-Control":"no-cache"}});return console.log(`[API Config] Respuesta de ${e}: ${n.status}`),n.ok}catch(o){return console.warn(`[API Config] Error verificando ${e}:`,o.message),!0}}async function c(e,o){if(o.setHeader("Access-Control-Allow-Credentials","true"),o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Methods","GET,OPTIONS,HEAD"),o.setHeader("Access-Control-Allow-Headers","Accept, Content-Type, Authorization"),o.setHeader("Access-Control-Max-Age","86400"),"OPTIONS"===e.method)return o.status(200).end();if("GET"!==e.method)return o.status(405).json({error:"M\xe9todo no permitido"});try{let r={timeout:15e3,retries:3,backoff:!0,endpoints:{woocommerce:{url:"/api/properties/sources/woocommerce",available:!0,params:{}},mongodb:{url:"/api/properties/sources/mongodb",available:!0,params:{}}},useProxyForMongoDB:!1},t=process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY||process.env.WOO_COMMERCE_KEY,n=process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET||process.env.WOO_COMMERCE_SECRET;t&&n?r.endpoints.woocommerce.params={consumer_key:t,consumer_secret:n}:(console.warn("[API Config] Faltan credenciales de WooCommerce"),r.endpoints.woocommerce.available=!1);let a=e.headers["x-forwarded-proto"]||(e.connection.encrypted?"https":"http"),s=`${a}://${e.headers.host}`;try{let e=`${s}${r.endpoints.woocommerce.url}`,o=await i(e,r.endpoints.woocommerce.params);r.endpoints.woocommerce.available=o}catch(e){console.warn("[API Config] Error verificando WooCommerce:",e)}try{let e=await i(`${s}${r.endpoints.mongodb.url}`);r.endpoints.mongodb.available=e}catch(e){console.warn("[API Config] Error verificando MongoDB:",e)}return o.setHeader("Cache-Control","s-maxage=300, stale-while-revalidate"),o.status(200).json({success:!0,config:r,message:"Configuraci\xf3n cargada correctamente"})}catch(e){return console.error("[API Config] Error general:",e),o.status(500).json({success:!1,error:"Error al obtener la configuraci\xf3n",details:e.message})}}let l=(0,s.M)(t,"default"),d=(0,s.M)(t,"config"),u=new n.PagesAPIRouteModule({definition:{kind:a.A.PAGES_API,page:"/api/config/properties",pathname:"/api/config/properties",bundlePath:"",filename:""},userland:t})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,o)=>{Object.defineProperty(o,"M",{enumerable:!0,get:function(){return function e(o,r){return r in o?o[r]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,r)):"function"==typeof o&&"default"===r?o:void 0}}})}};var o=require("../../../webpack-api-runtime.js");o.C(e);var r=o(o.s=58341);module.exports=r})();