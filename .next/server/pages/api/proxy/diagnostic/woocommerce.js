"use strict";(()=>{var e={};e.id=6164,e.ids=[6164],e.modules={8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return o}});var o=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,r,o)=>{e.exports=o(75600)},61773:(e,r,o)=>{o.d(r,{A:()=>u});let t="1"===process.env.VERCEL,s=process.env.NEXT_PUBLIC_WC_API_URL||"https://wordpress.realestategozamadrid.com/wp-json/wc/v3",c=process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY,n=process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET;console.log(`[WooConfig] Configuraci\xf3n cargada:`,{entorno:"production",isVercel:t,hasKey:!!c,hasSecret:!!n,apiUrl:s});let a={PRODUCTS:"/products",PRODUCT:e=>`/products/${e}`,CATEGORIES:"/products/categories",CATEGORY:e=>`/products/categories/${e}`},i={headers:{Accept:"application/json","Content-Type":"application/json"}},p=(e,r={})=>{try{let o=new URL(`${s}${e}`);return c&&n?(o.searchParams.append("consumer_key",c),o.searchParams.append("consumer_secret",n)):console.warn("[WooConfig] Advertencia: Construyendo URL sin credenciales de WooCommerce"),Object.entries(r).forEach(([e,r])=>{o.searchParams.append(e,r)}),o.toString()}catch(r){return console.error("[WooConfig] Error construyendo URL:",r.message),`${s}${e}?consumer_key=${c}&consumer_secret=${n}`}},d=(e,r)=>"string"!=typeof e?(console.warn("[WooConfig] Intento de split en un valor no string:",e),[]):e.split(r),u={WC_API_URL:s,WOO_COMMERCE_KEY:c,WOO_COMMERCE_SECRET:n,ENDPOINTS:a,isVercel:t,isDevelopment:!1,hasCredentials:()=>!!(c&&n),getProductUrl:(e,r={})=>p(a.PRODUCT(e),r),getProductsUrl:(e={})=>p(a.PRODUCTS,e),getAuth:()=>({key:c,secret:n}),getFetchConfig:(e={})=>({...i,...e}),getDirectProductUrl:e=>`${s}/products/${e}?consumer_key=${c}&consumer_secret=${n}`,getDirectProductsUrl:()=>`${s}/products?consumer_key=${c}&consumer_secret=${n}`,safeSplit:d,getWooCommerceApiUrl:()=>"string"!=typeof s?(console.warn("[WooConfig] WC_API_URL no es una cadena v\xe1lida:",s),"https://wordpress.realestategozamadrid.com/wp-json/wc/v3"):d(s,"?")[0]||"https://wordpress.realestategozamadrid.com/wp-json/wc/v3"}},72044:(e,r,o)=>{o.r(r),o.d(r,{config:()=>d,default:()=>p,routeModule:()=>u});var t={};o.r(t),o.d(t,{default:()=>i});var s=o(33480),c=o(8667),n=o(86435);o(94749);var a=o(61773);async function i(e,r){if(r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Allow-Methods","GET, POST, OPTIONS"),r.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization, Cache-Control, Accept"),"OPTIONS"===e.method)return r.status(200).end();try{let e,o=a.A.WOO_COMMERCE_KEY,t=a.A.WOO_COMMERCE_SECRET;if(!o||!t)return console.error("[Diagn\xf3stico WooCommerce] Faltan credenciales"),r.status(500).json({error:"Faltan credenciales de WooCommerce",details:"No se han configurado las credenciales necesarias para acceder a la API de WooCommerce"});let s=`${a.A.WC_API_URL}/products?consumer_key=${o}&consumer_secret=${t}`;if(console.log(`[Diagn\xf3stico WooCommerce] Conectando a: ${s.replace(/consumer_key=.*?&/,"consumer_key=HIDDEN&").replace(/consumer_secret=.*?($|&)/,"consumer_secret=HIDDEN$1")}`),!s.startsWith("https"))return console.error(`[Diagn\xf3stico WooCommerce] Error: URL insegura (${s.replace(/consumer_key=.*?&/,"consumer_key=HIDDEN&").replace(/consumer_secret=.*?($|&)/,"consumer_secret=HIDDEN$1")}) en producci\xf3n`),r.status(400).json({error:"URL insegura en producci\xf3n",message:"Las solicitudes en producci\xf3n deben usar HTTPS",url:s.replace(/consumer_key=.*?&/,"consumer_key=HIDDEN&").replace(/consumer_secret=.*?($|&)/,"consumer_secret=HIDDEN$1")});try{e=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","User-Agent":"GozaMadrid/1.0"}})}catch(e){throw e}if(!e.ok){let o=await e.text();return console.error(`[Diagn\xf3stico WooCommerce] Error de respuesta (${e.status}): ${o.substring(0,500)}`),r.status(e.status).json({error:`Error en la API de WooCommerce: ${e.status} ${e.statusText}`,details:o})}let c=await e.json();return console.log(`[Diagn\xf3stico WooCommerce] \xc9xito: ${c.length} productos recuperados`),r.status(200).json(c)}catch(t){console.error("[Diagn\xf3stico WooCommerce] Error:",t);let e=t.message,o="error_general";return t.message.includes("CORS")?(o="error_cors",e="Error de CORS: El servidor remoto no permite peticiones desde este origen"):t.message.includes("certificate")?(o="error_ssl",e="Error de SSL: Certificado inv\xe1lido o problema de seguridad"):t.message.includes("fetch")?(o="error_fetch",e="Error en la petici\xf3n: No se pudo realizar la conexi\xf3n"):t.message.includes("Mixed Content")&&(o="error_mixed_content",e="Error de contenido mixto: Intentando cargar contenido HTTP desde una p\xe1gina HTTPS"),r.status(500).json({error:"Error al conectar con la API de WooCommerce",message:e,type:o,details:t.stack})}}let p=(0,n.M)(t,"default"),d=(0,n.M)(t,"config"),u=new s.PagesAPIRouteModule({definition:{kind:c.A.PAGES_API,page:"/api/proxy/diagnostic/woocommerce",pathname:"/api/proxy/diagnostic/woocommerce",bundlePath:"",filename:""},userland:t})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,o){return o in r?r[o]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,o)):"function"==typeof r&&"default"===o?r:void 0}}})},94749:(e,r,o)=>{o.d(r,{A:()=>i});let t="https://www.realestategozamadrid.com",s="https://wordpress.realestategozamadrid.com/wp-json/wp/v2",c="https://wordpress.realestategozamadrid.com/wp-json/wc/v3",n={headers:{Accept:"application/json","Content-Type":"application/json"}},a={SITE_URL:t,WP_API_URL:s,WC_API_URL:c,defaultFetchConfig:n,WOO_COMMERCE_KEY:process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY||"ck_d4c3f5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3",WOO_COMMERCE_SECRET:process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET||"cs_c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3",ITEMS_PER_PAGE:12,API_PROXY:{MONGODB:"api/properties/sources/mongodb",PROPERTIES:"api/properties",WOOCOMMERCE:"api/woocommerce/products"},ENDPOINTS:{PROPERTIES:"api/properties",PROPERTY:"api/properties",CONTACT:"api/contact",CONFIG:"api/config/properties",WOOCOMMERCE:{PRODUCTS:"api/woocommerce/products",PRODUCT:e=>`api/woocommerce/products/${e}`}},getBaseUrl:()=>t,getEndpointUrl:e=>{let r=e.startsWith("/")?e.slice(1):e;return`${t}/${r}`},getMongoUrl:(e=null)=>{let r="api/properties/sources/mongodb";return e?`${r}/${e}`:r},getWooCommerceUrl:(e=null)=>{let r="api/woocommerce/products";return e?`${r}/${e}`:r},getWordPressBaseUrl:()=>`${t}/api/proxy/wordpress`,getWooCommerceAuth:()=>({key:a.WOO_COMMERCE_KEY,secret:a.WOO_COMMERCE_SECRET}),getFetchConfig:(e={})=>({...n,...e})};process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY,process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET;let i=a}};var r=require("../../../../webpack-api-runtime.js");r.C(e);var o=r(r.s=72044);module.exports=o})();