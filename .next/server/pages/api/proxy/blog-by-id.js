"use strict";(()=>{var e={};e.id=6784,e.ids=[6784],e.modules={1428:e=>{e.exports=import("axios")},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return o}});var o=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,t,o)=>{e.exports=o(75600)},43313:(e,t,o)=>{o.a(e,async(e,a)=>{try{o.r(t),o.d(t,{default:()=>s});var r=o(1428),n=e([r]);async function s(e,t){if(t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, OPTIONS"),t.setHeader("Access-Control-Allow-Headers","Content-Type, Cache-Control, Pragma"),"OPTIONS"===e.method)return t.status(200).end();if("GET"!==e.method)return t.status(405).json({error:"M\xe9todo no permitido"});let{id:o,source:a}=e.query;if(!o)return t.status(400).json({error:"Se requiere un ID o slug de blog"});let n=o&&/^[0-9a-fA-F]{24}$/.test(o),s="mongodb"===a||!a&&n,i=process.env.NEXT_PUBLIC_API_MONGODB_URL||"http://gozamadrid-api-prod.eba-adypnjgx.eu-west-3.elasticbeanstalk.com";i.endsWith("/")&&(i=i.slice(0,-1));let l=process.env.NEXT_PUBLIC_WP_API_URL||"https://wordpress.realestategozamadrid.com/wp-json/wp/v2";console.log(`[proxy/blog-by-id] Procesando solicitud para ID: ${o}, Fuente: ${a||"auto"}, Usando MongoDB: ${s}`),console.log(`[proxy/blog-by-id] URLs configuradas: MongoDB=${i}, WordPress=${l}`),new Date().toISOString(),new Date().toLocaleDateString("es-ES");try{if(s)try{let e=i.endsWith("/")?i.slice(0,-1):i,a=`${e}/api/blogs/${o}`;console.log(`[proxy/blog-by-id] Intentando obtener blog de MongoDB: ${a}`),console.log(`[proxy/blog-by-id] Configuraci\xf3n: URL Base MongoDB=${i}, ID=${o}, isMongoId=${n}`);try{console.log(`[proxy/blog-by-id] Intentando acceso directo a: ${a}`);let e=await (0,r.default)({method:"GET",url:a,timeout:15e3,headers:{Accept:"application/json","Cache-Control":"no-cache, no-store",Pragma:"no-cache","User-Agent":"GozaMadrid-Frontend/1.0",Origin:"https://www.realestategozamadrid.com"}}).catch(e=>(console.log(`[proxy/blog-by-id] Error en acceso directo: ${e.message}`),null));if(e&&e.data&&(e.data._id||e.data.id)){console.log(`[proxy/blog-by-id] Blog encontrado con acceso directo: ${e.data.title||"Sin t\xedtulo"}`);let a=d(e.data,o,"mongodb-direct");return t.status(200).json(a)}}catch(e){console.log(`[proxy/blog-by-id] Error en acceso directo: ${e.message}`)}let s=await (0,r.default)({method:"POST",url:"/api/proxy-raw",timeout:1e4,data:{url:a,method:"GET",headers:{Accept:"application/json","Cache-Control":"no-cache, no-store",Pragma:"no-cache","User-Agent":"GozaMadrid-Frontend/1.0",Origin:"https://www.realestategozamadrid.com"}},validateStatus:function(e){return e<500}}).catch(e=>(console.error(`[proxy/blog-by-id] Error en solicitud proxy a MongoDB: ${e.message}`),{status:0,data:null}));if(s.status>=200&&s.status<300&&s.data){let e=s.data;if(e._id||e.id){console.log(`[proxy/blog-by-id] Blog encontrado en MongoDB: ${e.title||"Sin t\xedtulo"}`);let a=d(e,o,"mongodb");return t.status(200).json(a)}console.log(`[proxy/blog-by-id] Respuesta recibida pero sin blog v\xe1lido: ${JSON.stringify(s.data).substring(0,200)}`)}console.log(`[proxy/blog-by-id] Blog no encontrado en MongoDB o respuesta inv\xe1lida: ${s.status}`)}catch(e){console.error(`[proxy/blog-by-id] Error al conectar con MongoDB: ${e.message}`)}else try{let e=`${l}/posts?slug=${encodeURIComponent(o)}&_embed=true`;console.log(`[proxy/blog-by-id] Intentando obtener post de WordPress: ${e}`);let a=await (0,r.default)({method:"POST",url:"/api/proxy-raw",timeout:1e4,data:{url:e,method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-Frontend/1.0",Origin:"https://www.realestategozamadrid.com"}},validateStatus:function(e){return e<500}}).catch(e=>(console.error(`[proxy/blog-by-id] Error en solicitud proxy a WordPress: ${e.message}`),{status:0,data:null}));if(a.status>=200&&a.status<300&&a.data){let e=a.data;if(Array.isArray(e)&&e.length>0){let o=e[0];console.log(`[proxy/blog-by-id] Post encontrado en WordPress: ${o.id}`);let a={_id:`wp-${o.id}`,id:o.id,title:o.title?.rendered||"Sin t\xedtulo",content:o.content?.rendered||"<p>Sin contenido</p>",date:o.date||new Date().toISOString(),dateFormatted:new Date(o.date||new Date).toLocaleDateString("es-ES"),author:o._embedded?.author?.[0]?.name||"Equipo Goza Madrid",excerpt:o.excerpt?.rendered||"",source:"wordpress",slug:o.slug};return o._embedded&&o._embedded["wp:featuredmedia"]&&o._embedded["wp:featuredmedia"][0]?a.image={src:o._embedded["wp:featuredmedia"][0].source_url||"",alt:o.title?.rendered||"Imagen del blog"}:a.image={src:"/img/default-blog-image.jpg",alt:a.title},t.status(200).json(a)}}console.log(`[proxy/blog-by-id] Post no encontrado en WordPress o respuesta inv\xe1lida: ${a.status}`)}catch(e){console.error(`[proxy/blog-by-id] Error al conectar con WordPress: ${e.message}`)}if(s)try{let e=`${l}/posts?slug=${encodeURIComponent(o)}&_embed=true`;console.log(`[proxy/blog-by-id] Intentando obtener post de WordPress (alternativa): ${e}`);let a=await (0,r.default)({method:"POST",url:"/api/proxy-raw",timeout:1e4,data:{url:e,method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-Frontend/1.0",Origin:"https://www.realestategozamadrid.com"}}}).catch(e=>(console.error(`[proxy/blog-by-id] Error en solicitud proxy alternativa a WordPress: ${e.message}`),{status:0,data:null}));if(a.status>=200&&a.status<300&&a.data){let e=a.data;if(Array.isArray(e)&&e.length>0){let o=e[0];console.log(`[proxy/blog-by-id] Post encontrado en WordPress (alternativa): ${o.id}`);let a={_id:`wp-${o.id}`,id:o.id,title:o.title?.rendered||"Sin t\xedtulo",content:o.content?.rendered||"<p>Sin contenido</p>",date:o.date||new Date().toISOString(),dateFormatted:new Date(o.date||new Date).toLocaleDateString("es-ES"),author:o._embedded?.author?.[0]?.name||"Equipo Goza Madrid",excerpt:o.excerpt?.rendered||"",source:"wordpress",slug:o.slug};return o._embedded&&o._embedded["wp:featuredmedia"]&&o._embedded["wp:featuredmedia"][0]?a.image={src:o._embedded["wp:featuredmedia"][0].source_url||"",alt:o.title?.rendered||"Imagen del blog"}:a.image={src:"/img/default-blog-image.jpg",alt:a.title},t.status(200).json(a)}}}catch(e){console.error(`[proxy/blog-by-id] Error en b\xfasqueda alternativa en WordPress: ${e.message}`)}else try{if(24===o.length&&/^[0-9a-fA-F]{24}$/.test(o)){let e=`${i}/api/blogs/${o}`;console.log(`[proxy/blog-by-id] Intentando obtener blog de MongoDB (alternativa): ${e}`);let a=await (0,r.default)({method:"POST",url:"/api/proxy-raw",timeout:1e4,data:{url:e,method:"GET",headers:{Accept:"application/json","Cache-Control":"no-cache, no-store",Pragma:"no-cache","User-Agent":"GozaMadrid-Frontend/1.0",Origin:"https://www.realestategozamadrid.com"}}}).catch(e=>(console.error(`[proxy/blog-by-id] Error en solicitud proxy alternativa a MongoDB: ${e.message}`),{status:0,data:null}));if(a.status>=200&&a.status<300&&a.data){let e=a.data;if(e._id||e.id){console.log(`[proxy/blog-by-id] Blog encontrado en MongoDB (alternativa): ${e.title||"Sin t\xedtulo"}`);let a=d(e,o,"mongodb");return t.status(200).json(a)}}}}catch(e){console.error(`[proxy/blog-by-id] Error en b\xfasqueda alternativa en MongoDB: ${e.message}`)}console.log("[proxy/blog-by-id] Blog no encontrado en ninguna fuente, devolviendo datos de respaldo");let e={_id:o,id:o,title:"Blog no disponible temporalmente",content:`<p>Lo sentimos, este blog no est\xe1 disponible en este momento. Por favor, int\xe9ntelo de nuevo m\xe1s tarde.</p>
                <p>Informaci\xf3n t\xe9cnica: El ID ${o} no fue encontrado en la base de datos. Esto puede deberse a que el blog 
                ha sido eliminado o movido a otra ubicaci\xf3n.</p>
                <p>Puede regresar a la lista de blogs para ver el contenido disponible.</p>`,description:"Este blog no est\xe1 disponible temporalmente",slug:`blog-${o}`,date:new Date().toISOString(),dateFormatted:new Date().toLocaleDateString("es-ES"),image:{src:"/img/default-blog-image.jpg",alt:"Blog no disponible"},source:s?"mongodb-fallback":"wordpress-fallback",author:"Sistema Goza Madrid"};return t.status(207).json(e)}catch(a){console.error(`[proxy/blog-by-id] Error general: ${a.message}`),a.response&&console.error(`[proxy/blog-by-id] Status: ${a.response.status}, Datos:`,"object"==typeof a.response.data?JSON.stringify(a.response.data).substring(0,200):a.response.data);let e={_id:o,id:o,title:"Error al cargar el blog",content:`<p>Lo sentimos, ha ocurrido un error al intentar cargar este blog.</p>
                <p>Error: ${a.message||"Error de conexi\xf3n al servidor"}</p>
                <p>Por favor, intente nuevamente m\xe1s tarde o contacte al administrador del sitio si el problema persiste.</p>`,description:"Error al cargar el blog",slug:`blog-${o}`,date:new Date().toISOString(),dateFormatted:new Date().toLocaleDateString("es-ES"),image:{src:"/img/default-blog-image.jpg",alt:"Error al cargar blog"},source:"error",author:"Sistema Goza Madrid"};return t.status(207).json(e)}}function d(e,t,o){let a={...e},r={_id:a._id||a.id||t,id:a.id||a._id||t,title:a.title||"Sin t\xedtulo",content:a.content||a.description||"",description:a.description||a.excerpt||"",slug:a.slug||`blog-${t}`,date:a.date||a.createdAt||new Date().toISOString(),dateFormatted:new Date(a.date||a.createdAt||new Date).toLocaleDateString("es-ES"),source:o||"api",author:a.author||"Goza Madrid",category:a.category||"Blog"};if(a.readTime&&(r.readTime=a.readTime),a.button&&(r.button=a.button),a.tags&&(r.tags=a.tags),a.images&&a.images.length>0){r.images=a.images;let e=a.images[0];if(e){let t="string"==typeof e?e:e.src||e.url||"";r.image={src:t.startsWith("http")?`/api/proxy-image?url=${encodeURIComponent(t)}`:t,alt:r.title||"Imagen del blog"}}}else r.image?"string"==typeof r.image?r.image={src:r.image.startsWith("http")?`/api/proxy-image?url=${encodeURIComponent(r.image)}`:r.image,alt:r.title||"Imagen del blog"}:r.image&&r.image.src&&r.image.src.startsWith("http")&&!r.image.src.startsWith("/api/proxy-image")&&(r.image.src=`/api/proxy-image?url=${encodeURIComponent(r.image.src)}`):r.image={src:"/img/default-blog-image.jpg",alt:r.title||"Imagen del blog"};return console.log(`[processBlog] Procesando blog ${r._id}: T\xedtulo=${r.title}, Im\xe1genes=${r.images?.length||0}`),r}r=(n.then?(await n)():n)[0],a()}catch(e){a(e)}})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},81686:(e,t,o)=>{o.a(e,async(e,a)=>{try{o.r(t),o.d(t,{config:()=>g,default:()=>l,routeModule:()=>c});var r=o(33480),n=o(8667),s=o(86435),d=o(43313),i=e([d]);d=(i.then?(await i)():i)[0];let l=(0,s.M)(d,"default"),g=(0,s.M)(d,"config"),c=new r.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/proxy/blog-by-id",pathname:"/api/proxy/blog-by-id",bundlePath:"",filename:""},userland:d});a()}catch(e){a(e)}})},86435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,o){return o in t?t[o]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,o)):"function"==typeof t&&"default"===o?t:void 0}}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var o=t(t.s=81686);module.exports=o})();