"use strict";(()=>{var e={};e.id=8507,e.ids=[8507],e.modules={1428:e=>{e.exports=import("axios")},8667:(e,o)=>{Object.defineProperty(o,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},31270:(e,o,r)=>{r.a(e,async(e,a)=>{try{r.r(o),r.d(o,{default:()=>c});var s=r(1428);r(94749);var t=e([s]);s=(t.then?(await t)():t)[0];let i=process.env.NEXT_PUBLIC_WOO_COMMERCE_URL||"https://wordpress.realestategozamadrid.com/wp-json/wc/v3",n=process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY,p=process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET,l=e=>{if(!e)return"";let o=e;return o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace(/\[\/?vc_[^\]]*\]/g,"")).replace(/\[\/?fusion_[^\]]*\]/g,"")).replace(/\[vc_[^\/\]]+.*?\]/g,"")).replace(/\[\/vc_[^\]]*\]/g,"")).replace(/\[vc_[^\]]*\]/g,"")).replace(/\[vc_column_text[^\]]*show_more_toggle[^\]]*\]/g,"")).replace(/\[\/vc_column_text\]/g,"")).replace(/\[vc_column_text.*?\]/g,"")).replace(/\[[^\]]*\]/g,"")).replace(/\[[^\]]*$/g,""),[/<h[1-6][^>]*>\s*(?:Ubicación|Ubicación Privilegiada|Ubicacion|Location|Mapa|Map|Como llegar)[^<]*<\/h[1-6]>[\s\S]*?(?=<h[1-6]|$)/gi,/<h[1-6][^>]*>\s*Ubicaci[oóòn][^<]*<\/h[1-6]>[\s\S]*?(?=<h[1-6]|$)/gi,/<h[1-6][^>]*>\s*(?:UBICACI[OÓÒ]N|ubicaci[oóò]n)[^<]*<\/h[1-6]>[\s\S]*?(?=<h[1-6]|$)/gi,/<(?:div|section)[^>]*>[\s\S]*?(?:ubicaci[oóò]n|mapa|locali[zs]aci[oóò]n|location|map)[^<]*[\s\S]*?<\/(?:div|section)>/gi,/<(?:div|section)[^>]*(?:class|id)\s*=\s*["'][^"']*(?:map|ubicacion|location)[^"']*["'][^>]*>[\s\S]*?<\/(?:div|section)>/gi].forEach(e=>{o=o.replace(e,"")}),[/<iframe[^>]*(?:google\.com\/maps|maps\.google|google\.com\/embed|maps\/embed)[^>]*>[\s\S]*?<\/iframe>/gi,/<iframe[^>]*(?:maps\/place|maps\/search|maps\/dir|google.*?\/maps)[^>]*>[\s\S]*?<\/iframe>/gi,/<iframe[^>]*(?:src|data-src)\s*=\s*["'][^"']*(?:maps|google)[^"']*["'][^>]*>[\s\S]*?<\/iframe>/gi,/<iframe[^>]*>[\s\S]*?<\/iframe>/gi].forEach(e=>{o=o.replace(e,"")}),[/<div[^>]*class\s*=\s*["'][^"']*(?:map|mapa|ubicacion|location)[^"']*["'][^>]*>[\s\S]*?<\/div>/gi,/<div[^>]*id\s*=\s*["'][^"']*(?:map|mapa|ubicacion|location)[^"']*["'][^>]*>[\s\S]*?<\/div>/gi,/<div[^>]*>[\s\S]*?(?:mapa|ubicaci[oóò]n|location|map)[\s\S]*?<\/div>/gi,/<section[^>]*>[\s\S]*?(?:mapa|ubicaci[oóò]n|location|map)[\s\S]*?<\/section>/gi].forEach(e=>{o=o.replace(e,"")}),o=(o=(o=o.replace(/Mostrar m[aá]s|Mostrar menos|Show more|Show less/gi,"")).replace(/<button[^>]*>[^<]*(?:mostrar|show|more|menos|less)[^<]*<\/button>/gi,"")).replace(/<a[^>]*class\s*=\s*["'][^"']*(?:mostrar|show|more)[^"']*["'][^>]*>.*?<\/a>/gi,""),[/<p[^>]*>(?:\s|&nbsp;)*<\/p>/gi,/<div[^>]*>(?:\s|&nbsp;)*<\/div>/gi,/<span[^>]*>(?:\s|&nbsp;)*<\/span>/gi,/(?:<br\s*\/?>\s*)+/gi,/\s{2,}/g,/<p><\/p>/g,/<div><\/div>/g].forEach(e=>{o=o.replace(e," ")}),o=(o=(o=o.replace(/<p/g,'<p class="mb-4"')).replace(/<ul/g,'<ul class="ml-6 mb-6 list-disc"')).replace(/<h2/g,'<h2 class="text-2xl font-bold mb-4 mt-8"')},m=e=>{try{console.log("[WooCommerce Transform] Transformando propiedad:",e.id);let o=o=>{if(!e.meta_data||!Array.isArray(e.meta_data))return null;let r=e.meta_data.find(e=>e.key===o);return r?r.value:null},r=e.price;"string"==typeof r&&(r=parseFloat(r.replace(/[^\d.-]/g,"")));let a=[];e.images&&Array.isArray(e.images)&&e.images.length>0?(console.log(`[WooCommerce Transform] Propiedad ${e.id} tiene ${e.images.length} im\xe1genes`),console.log("[WooCommerce Transform] Primera imagen:",e.images[0]),a=e.images.map(o=>({id:o.id,src:o.src,alt:o.alt||e.name,name:o.name}))):console.log(`[WooCommerce Transform] Propiedad ${e.id} no tiene im\xe1genes`);let s=l(e.description||e.short_description||""),t={_id:e.id.toString(),id:e.id.toString(),title:e.name,description:s,price:r||0,images:a,bedrooms:o("bedrooms")||o("habitaciones")||"0",bathrooms:o("ba\xf1os")||o("bathrooms")||o("banos")||"0",area:o("living_area")||o("area")||o("m2")||"0",location:o("address")||o("location")||"",propertyType:e.categories?.[0]?.name||"Venta",features:[],status:"publish"===e.status?"Disponible":"No disponible",source:"woocommerce",type:"woocommerce",createdAt:e.date_created||new Date().toISOString(),updatedAt:e.date_modified||new Date().toISOString()};return console.log("[WooCommerce Transform] Propiedad transformada:",t._id),t}catch(o){return console.error("[WooCommerce Transform] Error transformando propiedad:",o.message),e}};async function c(e,o){if(o.setHeader("Access-Control-Allow-Credentials",!0),o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Methods","GET, OPTIONS"),o.setHeader("Access-Control-Allow-Headers","Content-Type, Cache-Control"),"OPTIONS"===e.method)return o.status(200).end();if("GET"!==e.method)return o.status(405).json({error:"M\xe9todo no permitido"});try{let{id:r}=e.query,a=new URLSearchParams({consumer_key:n,consumer_secret:p,status:"publish",per_page:50}),t=r?`${i}/products/${r}?${a}`:`${i}/products?${a}`;console.log("[WooCommerce Proxy] Iniciando petici\xf3n a:",t.replace(/consumer_key=.*?&/,"consumer_key=HIDDEN&").replace(/consumer_secret=.*?(&|$)/,"consumer_secret=HIDDEN$1"));let c=await s.default.get(t,{timeout:15e3,headers:{Accept:"application/json","Content-Type":"application/json"}});if(console.log("[WooCommerce Proxy] Respuesta recibida:",{status:c.status,dataLength:c.data?Array.isArray(c.data)?c.data.length:1:0}),!c.data)return console.error("[WooCommerce Proxy] No se recibieron datos"),o.status(404).json({error:"No se encontraron propiedades",details:"La respuesta est\xe1 vac\xeda"});let l=[];if(r){let e=m(c.data);e&&(l=[e])}else l=Array.isArray(c.data)?c.data.map(m).filter(Boolean):[m(c.data)].filter(Boolean);return console.log(`[WooCommerce Proxy] Transformadas ${l.length} propiedades`),o.setHeader("Cache-Control","s-maxage=300, stale-while-revalidate"),o.status(200).json(l)}catch(e){if(console.error("[WooCommerce Proxy] Error:",e),console.error("[WooCommerce Proxy] Detalles del error:",{status:e.response?.status,data:e.response?.data,headers:e.response?.headers,config:e.config}),e.response){let r=e.response.status,a=e.response.data?.message||e.message;return o.status(r).json({error:"Error en la petici\xf3n a WooCommerce",details:a,status:r})}if("ECONNABORTED"===e.code)return o.status(504).json({error:"Tiempo de espera agotado",details:"La petici\xf3n a WooCommerce tard\xf3 demasiado"});return o.status(500).json({error:"Error al obtener datos de WooCommerce",details:e.message})}}a()}catch(e){a(e)}})},33480:(e,o,r)=>{e.exports=r(75600)},34222:(e,o,r)=>{r.a(e,async(e,a)=>{try{r.r(o),r.d(o,{config:()=>l,default:()=>p,routeModule:()=>m});var s=r(33480),t=r(8667),c=r(86435),i=r(31270),n=e([i]);i=(n.then?(await n)():n)[0];let p=(0,c.M)(i,"default"),l=(0,c.M)(i,"config"),m=new s.PagesAPIRouteModule({definition:{kind:t.A.PAGES_API,page:"/api/proxy/woocommerce/products",pathname:"/api/proxy/woocommerce/products",bundlePath:"",filename:""},userland:i});a()}catch(e){a(e)}})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,o)=>{Object.defineProperty(o,"M",{enumerable:!0,get:function(){return function e(o,r){return r in o?o[r]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,r)):"function"==typeof o&&"default"===r?o:void 0}}})},94749:(e,o,r)=>{r.d(o,{A:()=>n});let a="https://www.realestategozamadrid.com",s="https://wordpress.realestategozamadrid.com/wp-json/wp/v2",t="https://wordpress.realestategozamadrid.com/wp-json/wc/v3",c={headers:{Accept:"application/json","Content-Type":"application/json"}},i={SITE_URL:a,WP_API_URL:s,WC_API_URL:t,defaultFetchConfig:c,WOO_COMMERCE_KEY:process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY||"ck_d4c3f5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3",WOO_COMMERCE_SECRET:process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET||"cs_c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3c5c3",ITEMS_PER_PAGE:12,API_PROXY:{MONGODB:"api/properties/sources/mongodb",PROPERTIES:"api/properties",WOOCOMMERCE:"api/woocommerce/products"},ENDPOINTS:{PROPERTIES:"api/properties",PROPERTY:"api/properties",CONTACT:"api/contact",CONFIG:"api/config/properties",WOOCOMMERCE:{PRODUCTS:"api/woocommerce/products",PRODUCT:e=>`api/woocommerce/products/${e}`}},getBaseUrl:()=>a,getEndpointUrl:e=>{let o=e.startsWith("/")?e.slice(1):e;return`${a}/${o}`},getMongoUrl:(e=null)=>{let o="api/properties/sources/mongodb";return e?`${o}/${e}`:o},getWooCommerceUrl:(e=null)=>{let o="api/woocommerce/products";return e?`${o}/${e}`:o},getWordPressBaseUrl:()=>`${a}/api/proxy/wordpress`,getWooCommerceAuth:()=>({key:i.WOO_COMMERCE_KEY,secret:i.WOO_COMMERCE_SECRET}),getFetchConfig:(e={})=>({...c,...e})};process.env.NEXT_PUBLIC_WOO_COMMERCE_KEY,process.env.NEXT_PUBLIC_WOO_COMMERCE_SECRET;let n=i}};var o=require("../../../../webpack-api-runtime.js");o.C(e);var r=o(o.s=34222);module.exports=r})();