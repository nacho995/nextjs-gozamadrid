(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8358],{53936:(e,o,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/[id]",function(){return t(63551)}])},63551:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>g});var r=t(37876),n=t(14232),a=t(77328),l=t.n(a),s=t(89099);async function c(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let r={method:"GET",headers:{"Content-Type":"application/json"}},n={...r,...t,headers:{...r.headers,...t.headers||{}}},a=new URLSearchParams;Object.entries(o).forEach(e=>{let[o,t]=e;a.append(o,t)});let l="".concat("/api/proxy/wordpress/".concat(e),"?").concat(a.toString()),s=await fetch(l,n);if(!s.ok)throw Error("Error en la API de WordPress: ".concat(s.status," ").concat(s.statusText));return await s.json()}catch(e){throw console.error("Error al obtener datos de WordPress:",e),e}}async function d(e){return c("posts",{slug:e,_embed:"true"})}var i=t(65364);let u="https://gozamadrid-api-prod.eba-adypnjgx.eu-west-3.elasticbeanstalk.com/api/blogs",p=i.env.NEXT_PUBLIC_WP_API_URL||"https://wordpress.realestategozamadrid.com/wp-json/wp/v2/posts",g=()=>{let e=(0,s.useRouter)(),{id:o,source:t}=e.query,[a,c]=(0,n.useState)(!0),[i,g]=(0,n.useState)(null),[h,m]=(0,n.useState)(null);(0,n.useEffect)(()=>{o&&(async()=>{c(!0),g(null);try{console.log("Intentando obtener blog con ID: ".concat(o,", source: ").concat(t||"no especificado"));let j=o&&24===o.length&&/^[0-9a-fA-F]{24}$/.test(o);"wordpress"===t||j||o.includes("-");let y="mongodb"===t||j;if(y)try{console.log("Consultando MongoDB con ID: ".concat(o));let e="/api/proxy/blog-by-id?id=".concat(o);try{console.log("Intentando nuevo endpoint: ".concat(e));let o=await fetch(e,{headers:{Accept:"application/json","Cache-Control":"no-cache, no-store",Pragma:"no-cache"}});if(o.ok){let e=await o.json();console.log("Blog encontrado a trav\xe9s del proxy:",(null==e?void 0:e.title)||"Sin t\xedtulo"),m(e),c(!1);return}console.log("Respuesta no OK desde ".concat(e,": ").concat(o.status))}catch(e){for(let t of(console.error("Error con el endpoint proxy: ".concat(e.message)),["".concat(u,"/").concat(o),"/api/proxy/mongodb/blogs/".concat(o),"https://www.realestategozamadrid.com/api/blogs/".concat(o),"https://www.realestategozamadrid.com/api/blogs/detail/".concat(o)]))try{console.log("Intentando URL: ".concat(t));let e=await fetch(t);if(e.ok){let o=await e.json();console.log("MongoDB blog encontrado:",(null==o?void 0:o.title)||"Sin t\xedtulo"),m(o),c(!1);return}console.log("Respuesta no OK desde ".concat(t,": ").concat(e.status))}catch(e){console.error("Error con URL ".concat(t,":"),e)}}console.log("No se encontr\xf3 el blog en MongoDB tras intentar m\xfaltiples URLs")}catch(e){console.error("Error general al intentar con MongoDB:",e)}if(!y||!h)try{var e,r,n,a,l,s,i,x,b,w,f,v;console.log("Consultando WordPress con slug: ".concat(o));try{let t=await d(o);if(t&&t.length>0){let o=t[0];console.log("WordPress post encontrado:",o.id);let d={title:(null==(e=o.title)?void 0:e.rendered)||"Sin t\xedtulo",content:(null==(r=o.content)?void 0:r.rendered)||"<p>Sin contenido</p>",date:o.date||new Date().toISOString(),author:(null==(l=o._embedded)||null==(a=l.author)||null==(n=a[0])?void 0:n.name)||"Equipo Goza Madrid",excerpt:(null==(s=o.excerpt)?void 0:s.rendered)||"",source:"wordpress"};m(d),c(!1);return}console.log("No se encontraron posts en WordPress")}catch(e){console.error("Error al consultar WordPress v\xeda proxy:",e);try{let e="/api/proxy-raw";console.log("Intentando fallback v\xeda proxy-raw: ".concat(e));let t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:"".concat(p,"?slug=").concat(encodeURIComponent(o),"&_embed=true"),method:"GET",headers:{Accept:"application/json"}})});if(t.ok){let e=await t.json();if(e&&Array.isArray(e)&&e.length>0){let o=e[0];console.log("WordPress post encontrado v\xeda proxy-raw:",o.id);let t={title:(null==(i=o.title)?void 0:i.rendered)||"Sin t\xedtulo",content:(null==(x=o.content)?void 0:x.rendered)||"<p>Sin contenido</p>",date:o.date||new Date().toISOString(),author:(null==(f=o._embedded)||null==(w=f.author)||null==(b=w[0])?void 0:b.name)||"Equipo Goza Madrid",excerpt:(null==(v=o.excerpt)?void 0:v.rendered)||"",source:"wordpress"};m(t),c(!1);return}}}catch(e){console.error("Error en fallback de WordPress:",e)}}}catch(e){console.error("Error general al cargar blog de WordPress:",e)}if(!y&&j)try{let e=await fetch("".concat(u,"/").concat(o));if(e.ok){let o=await e.json();console.log("MongoDB blog encontrado (intento tard\xedo):",(null==o?void 0:o.title)||"Sin t\xedtulo"),m(o),c(!1);return}}catch(e){console.error("Error en intento tard\xedo con MongoDB:",e)}console.error("Blog no encontrado en ninguna fuente"),g("Blog no encontrado"),m({title:"Blog no encontrado",content:"<p>Lo sentimos, no pudimos encontrar este blog. Por favor, verifica la URL o regresa a la lista de blogs.</p>",date:new Date().toISOString()})}catch(e){console.error("Error general al cargar el blog:",e),g("Error al cargar el blog"),m({title:"Error al cargar el blog",content:"<p>Se produjo un error al cargar el contenido del blog. Por favor, int\xe9ntalo m\xe1s tarde.</p>",date:new Date().toISOString()})}finally{c(!1)}})()},[o,t]);let x=e=>e?"string"==typeof e?e:"object"==typeof e&&e.rendered?e.rendered:String(e):"";if(a)return(0,r.jsx)("div",{className:"container mx-auto p-12 text-center",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[50vh]",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-t-4 border-blue-500 border-solid rounded-full animate-spin mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Cargando blog..."}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Por favor espere mientras obtenemos el contenido"})]})});if(!h)return(0,r.jsx)("div",{className:"container mx-auto p-8",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,r.jsx)("h2",{className:"text-lg mb-2",children:"Error al cargar el blog"}),(0,r.jsx)("p",{className:"text-sm",children:i||"No se pudo cargar el blog solicitado"}),(0,r.jsx)("button",{onClick:()=>e.push("/blog"),className:"mt-4 bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700",children:"Volver al blog"})]})});let b=x(h.title),w=x(h.content),f=x(h.excerpt||h.description||""),v="Fecha no disponible";try{h.date&&(v=new Date(h.date).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}))}catch(e){}return(0,r.jsxs)("div",{children:[(0,r.jsxs)(l(),{children:[(0,r.jsx)("title",{children:b||"Blog - Real Estate Goza Madrid"}),(0,r.jsx)("meta",{name:"description",content:f||"Art\xedculo del blog de Real Estate Goza Madrid"})]}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-12",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("button",{onClick:()=>e.push("/blog"),className:"inline-flex items-center text-blue-600 hover:text-blue-800",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10.707 4.293a1 1 0 010 1.414L7.414 9H15a1 1 0 110 2H7.414l3.293 3.293a1 1 0 01-1.414 1.414l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Volver al blog"]})}),(0,r.jsx)("article",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,r.jsxs)("div",{className:"p-6 md:p-8",children:[(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:b}),(0,r.jsxs)("div",{className:"flex items-center text-gray-600 mb-6",children:[(0,r.jsx)("span",{className:"mr-4",children:v}),h.author&&(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"string"==typeof h.author?h.author:"Equipo Goza Madrid"]})]}),(0,r.jsx)("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:w}})]})})]})]})}}},e=>{var o=o=>e(e.s=o);e.O(0,[636,6593,8792],()=>o(53936)),_N_E=e.O()}]);