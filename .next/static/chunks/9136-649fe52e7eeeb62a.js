"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9136],{37494:(e,t,o)=>{o.d(t,{XL:()=>c}),o(2805);var a=o(65364);a.env.NEXT_PUBLIC_WP_API_URL;let r=a.env.NEXT_PUBLIC_WP_PROXY_URL||"https://www.realestategozamadrid.com/api/wordpress-proxy";a.env.WORDPRESS_API_URL;let s=e=>null==e?"":"string"==typeof e?e:"number"==typeof e||"boolean"==typeof e?String(e):"object"==typeof e?e.rendered?e.rendered:JSON.stringify(e):String(e);class n{async withRetry(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.retryAttempts;for(let a=1;a<=o;a++)try{return await e()}catch(r){if(t=r,a===o)throw r;let e=this.retryDelay*Math.pow(2,a-1);console.log("[BlogAPI] Retry ".concat(a,"/").concat(o," en ").concat(e,"ms...")),await this.sleep(e)}throw t}async sleep(e){return new Promise(t=>setTimeout(t,e))}getCached(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>this.cacheExpiry?(this.cache.delete(e),null):t.data:null}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}async getBlogPosts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="blogs-".concat(e),o=this.getCached(t);if(o)return console.log("[BlogAPI] ✅ Datos desde cache"),o;console.log("[BlogAPI] \uD83D\uDD04 Iniciando obtenci\xf3n de blogs...");try{let e=await this.withRetry(async()=>{let e=await fetch("/api/wordpress-proxy",{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-BlogAPI/2.0","Cache-Control":"no-cache"},signal:AbortSignal.timeout(15e3)});if(!e.ok)throw Error("WordPress API failed: ".concat(e.status));let t=await e.json();if(!Array.isArray(t)||0===t.length)throw Error("WordPress returned empty data");return t});if(e&&e.length>0){console.log("[BlogAPI] ✅ WordPress exitoso: ".concat(e.length," blogs"));let o={posts:e,source:"wordpress"};return this.setCache(t,o),o}}catch(e){console.log("[BlogAPI] ⚠️ WordPress fall\xf3: ".concat(e.message))}try{let o=await this.withRetry(async()=>{let e=await fetch("https://gw.estateinsight.zone/api/estates/blogs?limit=100",{method:"GET",headers:{Accept:"application/json","User-Agent":"GozaMadrid-BlogAPI/2.0","X-API-Key":a.env.AWS_API_KEY||""},signal:AbortSignal.timeout(12e3)});if(!e.ok)throw Error("AWS API failed: ".concat(e.status));let t=await e.json();if(!t.success||!Array.isArray(t.data)||0===t.data.length)throw Error("AWS returned invalid data");return t.data});if(o&&o.length>0){console.log("[BlogAPI] ✅ AWS exitoso: ".concat(o.length," blogs"));let a={posts:o.slice(0,e).map(e=>{var t;return{id:e.id||Math.random().toString(36).substr(2,9),title:{rendered:e.title||"Sin t\xedtulo"},excerpt:{rendered:e.description||""},content:{rendered:e.content||""},date:e.date||new Date().toISOString(),slug:e.slug||"blog-post",featured_media:0,featured_image_url:(null==(t=e.image)?void 0:t.src)||"https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&h=600&fit=crop&q=80",author_name:e.author||"Equipo Goza Madrid",source:"aws"}}),source:"aws"};return this.setCache(t,a),a}}catch(e){console.log("[BlogAPI] ⚠️ AWS fall\xf3: ".concat(e.message))}try{let o=await fetch("/api/blogs-backup",{method:"GET",headers:{Accept:"application/json"}});if(o.ok){let a=await o.json();if(Array.isArray(a)&&a.length>0){console.log("[BlogAPI] ✅ Respaldo exitoso: ".concat(a.length," blogs"));let o={posts:a.slice(0,e),source:"backup"};return this.setCache(t,o),o}}}catch(e){console.error("[BlogAPI] ❌ Respaldo fall\xf3: ".concat(e.message))}return console.log("[BlogAPI] \uD83C\uDD98 Usando blogs hardcoded como \xfaltimo recurso"),{posts:[{id:"fallback-1",title:{rendered:"Bienvenido a Goza Madrid"},excerpt:{rendered:"Estamos preparando contenido incre\xedble para ti."},content:{rendered:"<p>Muy pronto tendr\xe1s acceso a nuestros blogs sobre el mercado inmobiliario en Madrid.</p>"},date:new Date().toISOString(),slug:"bienvenido-goza-madrid",featured_image_url:"https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&h=600&fit=crop&q=80",author_name:"Equipo Goza Madrid",source:"fallback"}],source:"fallback"}}clearCache(){this.cache.clear(),console.log("[BlogAPI] Cache limpiado")}constructor(){this.cache=new Map,this.cacheExpiry=3e5,this.retryAttempts=3,this.retryDelay=1e3}}let l=new n;async function c(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{return await l.getBlogPosts(e)}catch(e){return console.error("[BlogAPI] Error fatal:",e),{posts:[],source:"error",error:e.message}}}},73867:(e,t,o)=>{o.d(t,{A:()=>d});var a=o(37876),r=o(14232);o(68827);var s=o(77328),n=o.n(s);o(65364).env.NEXT_PUBLIC_API_URL;let l=["https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&h=600&fit=crop&q=80","https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=800&h=600&fit=crop&q=80","https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=800&h=600&fit=crop&q=80"],c=e=>!e||"string"!=typeof e||e.includes("via.placeholder.com")||e.includes("placeholder.com")||e.includes("example.com")?null:(e.includes("wordpress.realestategozamadrid.com")&&(e=e.replace("wordpress.realestategozamadrid.com","www.realestategozamadrid.com")),e.startsWith("http:")&&(e=e.replace("http:","https:")),e),i=e=>{let t=c(e);if(!t)return null;if(t.includes("unsplash.com")||t.includes("images.unsplash.com"))return t;if(t.includes("realestategozamadrid.com")&&t.includes("wp-content"))return"/api/proxy-image?url=".concat(encodeURIComponent(t));try{return"https://images.weserv.nl/?url=".concat(encodeURIComponent(t),"&w=800&h=600&fit=cover&default=").concat(encodeURIComponent(l[0]))}catch(e){return console.error("[BlogImage] Error creando proxy URL:",e),null}},d=e=>{let{src:t,alt:o,className:s="",priority:d=!1,sizes:g="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw",fallbackSrc:h}=e,[p,u]=(0,r.useState)(!1),[m,f]=(0,r.useState)(!1),[w,y]=(0,r.useState)(!0),b=(0,r.useRef)(null),[I,A]=(0,r.useState)({width:800,height:600}),[P,x]=(0,r.useState)({original:null,processed:null}),[v,S]=(0,r.useState)(""),[j,_]=(0,r.useState)(0);(0,r.useEffect)(()=>{u(!0)},[]);let E=(0,r.useCallback)(e=>{if(h){let e=c(h);if(e)return e}let t=i(e);return t||l[0]},[h]);(0,r.useEffect)(()=>{u(!0),S(E(t))},[t,E]);let B=(0,r.useCallback)(()=>{if(console.error("Error cargando imagen: ".concat(v,", usando fallback")),f(!0),j<l.length-1){let e=j+1;_(e),S(l[e]),f(!1)}else S(l[l.length-1])},[v,j]),C=(0,r.useCallback)(()=>{y(!1),f(!1)},[]),R="blog-image-".concat(Math.random().toString(36).substring(2,9)),U={"@context":"https://schema.org","@type":"ImageObject","@id":"#".concat(R),contentUrl:v,name:o||"Imagen del blog",description:o||"Fotograf\xeda del blog",representativeOfPage:d};return p?m||!v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n(),{children:(0,a.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({...U,contentUrl:l[j]})}})}),(0,a.jsxs)("div",{className:"flex items-center justify-center bg-gray-200 ".concat(s),ref:b,itemScope:!0,itemType:"https://schema.org/ImageObject","aria-label":"Imagen no disponible",role:"img",itemID:"#".concat(R),children:[(0,a.jsx)("img",{src:l[j],alt:o||"Imagen no disponible",className:"object-cover w-full h-full"}),(0,a.jsx)("meta",{itemProp:"contentUrl",content:l[j]}),(0,a.jsx)("meta",{itemProp:"name",content:o||"Imagen no disponible"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n(),{children:(0,a.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(U)}})}),(0,a.jsxs)("div",{ref:b,className:"relative overflow-hidden",itemScope:!0,itemType:"https://schema.org/ImageObject",itemID:"#".concat(R),children:[w&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:(0,a.jsx)("div",{className:"animate-pulse bg-gray-200 rounded-full h-16 w-16"})}),(0,a.jsx)("img",{src:v,alt:o||"Imagen del blog",className:"w-full h-full object-cover ".concat(s),onError:B,onLoad:C,loading:d?"eager":"lazy",decoding:"async",itemProp:"contentUrl","data-debug":JSON.stringify(P)}),(0,a.jsx)("meta",{itemProp:"name",content:o||"Fotograf\xeda del blog"}),(0,a.jsx)("meta",{itemProp:"representativeOfPage",content:d?"true":"false"})]})]}):null}}}]);