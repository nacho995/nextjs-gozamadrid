(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3868],{76154:(e,r,o)=>{"use strict";o.d(r,{default:()=>i});var a=o(13929),s=o(63453);let t=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new AbortController,{signal:a}=o,s=setTimeout(()=>{o.abort()},6e4);try{let o=await fetch(e,{...r,signal:a});if(clearTimeout(s),!o.ok)throw Error("Error HTTP: ".concat(o.status));return o}catch(e){if(clearTimeout(s),"AbortError"===e.name)throw Error("La petici\xf3n ha excedido el tiempo m\xe1ximo");throw e}},n=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r="".concat("/api/proxy?service=woocommerce","&resource=products");Object.entries(e).forEach(e=>{let[o,a]=e;r+="&".concat(encodeURIComponent(o),"=").concat(encodeURIComponent(a))});try{let e=await t(r,{headers:{"Content-Type":"application/json","User-Agent":"Mozilla/5.0 (compatible; GozaMadridBot/1.0)"}});return await e.json()}catch(e){return console.error("Error fetching properties:",e),[]}},l=async e=>{try{let r=await t("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error("Error: ".concat(r.status));return await r.json()}catch(e){throw console.error("Error al enviar el formulario de contacto:",e),e}};function i(){let[e,r]=(0,s.useState)([]),[o,t]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,m]=(0,s.useState)({name:"",email:"",message:""}),[u,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{t(!0);let e=await n();r(e),c(null)}catch(e){console.error("Error fetching properties:",e),c("No se pudieron cargar las propiedades. Intente nuevamente m\xe1s tarde.")}finally{t(!1)}})()},[]);let h=e=>{let{name:r,value:o}=e.target;m(e=>({...e,[r]:o}))},b=async e=>{e.preventDefault();try{p("sending"),await l(d),p("success"),m({name:"",email:"",message:""})}catch(e){console.error("Error submitting form:",e),p("error")}};return(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Ejemplo de API con HTTPS a trav\xe9s de Cloudflare"}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Propiedades"}),o&&(0,a.jsx)("p",{children:"Cargando propiedades..."}),i&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:i}),!o&&!i&&(0,a.jsx)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:e.length>0?e.map(e=>(0,a.jsxs)("div",{className:"border rounded p-4 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-bold",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600",children:e.location}),(0,a.jsxs)("p",{className:"text-green-600 font-semibold",children:[e.price,"â‚¬"]})]},e._id)):(0,a.jsx)("p",{children:"No hay propiedades disponibles."})})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg shadow-sm",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Formulario de Contacto"}),"success"===u&&(0,a.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:"\xa1Mensaje enviado correctamente! Nos pondremos en contacto contigo pronto."}),"error"===u&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:"Ha ocurrido un error al enviar el mensaje. Por favor, intenta nuevamente."}),(0,a.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:d.name,onChange:h,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:d.email,onChange:h,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje"}),(0,a.jsx)("textarea",{id:"message",name:"message",value:d.message,onChange:h,required:!0,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsx)("button",{type:"submit",disabled:"sending"===u,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:"sending"===u?"Enviando...":"Enviar mensaje"})]})]})]})}},80255:(e,r,o)=>{Promise.resolve().then(o.bind(o,76154))}},e=>{var r=r=>e(e.s=r);e.O(0,[8768,430,7358],()=>r(80255)),_N_E=e.O()}]);