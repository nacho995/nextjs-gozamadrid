"use strict";(()=>{var e={};e.id=982,e.ids=[220,636,982],e.modules={7085:e=>{e.exports=require("styled-jsx/style")},8732:e=>{e.exports=require("react/jsx-runtime")},19121:e=>{e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22326:e=>{e.exports=require("react-dom")},27910:e=>{e.exports=require("stream")},28311:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29825:e=>{e.exports=require("prop-types")},33873:e=>{e.exports=require("path")},34807:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var o=r(8732),s=r(7085),a=r.n(s),i=r(82015),d=r(68030),n=r.n(d),l=r(75512),p=r.n(l);function c(){let[e,t]=(0,i.useState)([]),[r,s]=(0,i.useState)(!0),[d,l]=(0,i.useState)(null),[c,x]=(0,i.useState)([]),[g,f]=(0,i.useState)("https://goza-madrid.onrender.com"),u=e=>{x(t=>[...t,{time:new Date().toISOString(),message:e}])},m=async()=>{try{s(!0);let e=`${window.location.origin}/api/properties-all`;u(`Intentando cargar propiedades desde el endpoint combinado: ${e}`);let r=await fetch(e,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(r.ok){let e=await r.json();if(u(`Respuesta obtenida: ${JSON.stringify(e).substring(0,100)}...`),e.properties&&Array.isArray(e.properties)){u(`Propiedades cargadas: ${e.properties.length} (MongoDB: ${e.sources.mongodb}, WooCommerce: ${e.sources.woocommerce})`);let r=e.properties.map(e=>({id:e._id||e.id,title:e.title||e.name||"Sin t\xedtulo",price:e.price||"No disponible",location:e.location||"No disponible",source:e.source||(e._id?"MongoDB":"WooCommerce"),date:e.date||e.dateFormatted||"Desconocida"}));t(r),l(null)}else u(`La respuesta no tiene propiedades en el formato esperado: ${JSON.stringify(e).substring(0,100)}...`),l("La respuesta no tiene el formato esperado"),h()}else u(`Error al cargar propiedades: ${r.status} ${r.statusText}`),l(`Error ${r.status}: ${r.statusText}`),h()}catch(e){u(`Error: ${e.message}`),l(e.message),h()}finally{s(!1)}},h=()=>{u("Intentando m\xe9todo original como respaldo..."),b(`${g}/property`)},b=async e=>{try{s(!0),u(`Intentando cargar propiedades desde: ${e}`);let r=await fetch(e,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(r.ok){let e=await r.json();if(u(`Propiedades cargadas: ${Array.isArray(e)?e.length:"No es un array"}`),Array.isArray(e)){let r=e.map(e=>({id:e._id||e.id,title:e.title||e.name||"Sin t\xedtulo",price:e.price||"No disponible",location:e.location||"No disponible",source:e._id?"MongoDB":"WooCommerce"}));t(r),l(null)}else u(`La respuesta no es un array: ${JSON.stringify(e).substring(0,100)}...`),l("La respuesta no tiene el formato esperado")}else u(`Error al cargar propiedades: ${r.status} ${r.statusText}`),l(`Error ${r.status}: ${r.statusText}`)}catch(e){u(`Error: ${e.message}`),l(e.message)}finally{s(!1)}},y=async e=>{try{u(`Probando propiedad con ID: ${e}`),s(!0);let t=`${g}/property/${e}`;u(`URL: ${t}`);let r=await fetch(t,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!r.ok)return u(`Error al cargar propiedad: ${r.status} ${r.statusText}`),!1;{let e=await r.json();return u(`Propiedad cargada correctamente: ${e.title||e.name||"Sin t\xedtulo"}`),u(`ID: ${e._id||e.id}`),u(`T\xedtulo: ${e.title||e.name||"Sin t\xedtulo"}`),u(`Precio: ${e.price||"No disponible"}`),u(`Ubicaci\xf3n: ${e.location||"No disponible"}`),u(`Im\xe1genes: ${e.images?Array.isArray(e.images)?e.images.length:"1":"0"}`),!0}}catch(e){return u(`Error al probar propiedad: ${e.message}`),!1}finally{s(!1)}},j=async()=>{for(let e of["65e9f2a0e6d7b9a7f2d7b9a7","123456"]){if(u(`Probando ID de ejemplo: ${e}`),await y(e)){u(`Prueba exitosa con ID: ${e}`);break}u(`Prueba fallida con ID: ${e}`)}};return(0,o.jsxs)("div",{style:{fontFamily:"Arial, sans-serif",maxWidth:"1200px",margin:"0 auto",padding:"20px"},children:[(0,o.jsxs)(n(),{children:[(0,o.jsx)("title",{children:"Listar Propiedades | Goza Madrid"}),(0,o.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,o.jsx)("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px"},children:"Listar Propiedades"}),(0,o.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f3f4f6",borderRadius:"4px"},children:[(0,o.jsx)("h2",{style:{fontWeight:"bold",marginBottom:"10px"},children:"Configuraci\xf3n"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"5px"},children:"URL del servidor:"}),(0,o.jsx)("input",{type:"text",value:g,onChange:e=>{f(e.target.value)},style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"}})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,o.jsx)("button",{onClick:()=>{m()},disabled:r,style:{padding:"8px 16px",backgroundColor:r?"#ccc":"#f59e0b",color:"#000",border:"none",borderRadius:"4px",fontWeight:"bold",cursor:r?"not-allowed":"pointer"},children:r?"Cargando...":"Cargar propiedades"}),(0,o.jsx)("button",{onClick:j,disabled:r,style:{padding:"8px 16px",backgroundColor:r?"#ccc":"#3b82f6",color:"#fff",border:"none",borderRadius:"4px",fontWeight:"bold",cursor:r?"not-allowed":"pointer"},children:"Probar ID de ejemplo"})]})]})]}),d&&(0,o.jsxs)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #ef4444",color:"#b91c1c",padding:"10px",borderRadius:"4px",marginBottom:"20px"},children:[(0,o.jsx)("h2",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Error"}),(0,o.jsx)("p",{children:d})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"20px"},children:[(0,o.jsxs)("div",{style:{backgroundColor:"#f3f4f6",padding:"15px",borderRadius:"4px"},children:[(0,o.jsx)("h2",{style:{fontWeight:"bold",marginBottom:"10px"},children:"Propiedades"}),(0,o.jsx)("div",{style:{backgroundColor:"#fff",border:"1px solid #ccc",padding:"15px",borderRadius:"4px",height:"400px",overflowY:"auto"},children:r?(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},className:"jsx-e1a5dd452c21a721",children:[(0,o.jsx)("div",{style:{border:"4px solid #f3f4f6",borderTopColor:"#f59e0b",borderRadius:"50%",width:"50px",height:"50px",animation:"spin 1s linear infinite"},className:"jsx-e1a5dd452c21a721"}),(0,o.jsx)(a(),{id:"e1a5dd452c21a721",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):e.length>0?(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"ID"}),(0,o.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"T\xedtulo"}),(0,o.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"Precio"}),(0,o.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"Ubicaci\xf3n"}),(0,o.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"Fuente"}),(0,o.jsx)("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #ddd"},children:"Acciones"})]})}),(0,o.jsx)("tbody",{children:e.map((e,t)=>(0,o.jsxs)("tr",{style:{backgroundColor:t%2==0?"#f9fafb":"#fff"},children:[(0,o.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:(0,o.jsx)("span",{style:{fontFamily:"monospace",fontSize:"14px"},children:e.id})}),(0,o.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:e.title}),(0,o.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:e.price}),(0,o.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:e.location}),(0,o.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:e.source}),(0,o.jsx)("td",{style:{padding:"8px",borderBottom:"1px solid #ddd"},children:(0,o.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,o.jsx)(p(),{href:`/diagnostico-simple?id=${e.id}`,passHref:!0,children:(0,o.jsx)("a",{style:{padding:"4px 8px",backgroundColor:"#f59e0b",color:"#000",borderRadius:"4px",textDecoration:"none",fontSize:"14px"},children:"Diagnosticar"})}),(0,o.jsx)("button",{onClick:()=>y(e.id),style:{padding:"4px 8px",backgroundColor:"#10b981",color:"#fff",borderRadius:"4px",border:"none",fontSize:"14px",cursor:"pointer"},children:"Probar"})]})})]},t))})]}):(0,o.jsx)("p",{style:{color:"#6b7280",textAlign:"center"},children:"No se encontraron propiedades"})})]}),(0,o.jsxs)("div",{style:{backgroundColor:"#f3f4f6",padding:"15px",borderRadius:"4px"},children:[(0,o.jsx)("h2",{style:{fontWeight:"bold",marginBottom:"10px"},children:"Logs"}),(0,o.jsx)("div",{style:{backgroundColor:"#000",color:"#4ade80",padding:"10px",borderRadius:"4px",height:"300px",overflowY:"auto",fontFamily:"monospace",fontSize:"14px"},children:0===c.length?(0,o.jsx)("p",{style:{color:"#6b7280"},children:"No hay logs disponibles"}):c.map((e,t)=>(0,o.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,o.jsxs)("span",{style:{color:"#6b7280"},children:["[",e.time.split("T")[1].split(".")[0],"]"]})," ",e.message]},t))}),(0,o.jsx)("div",{style:{marginTop:"10px"},children:(0,o.jsx)("button",{onClick:()=>x([]),style:{padding:"4px 8px",backgroundColor:"#ef4444",color:"#fff",border:"none",borderRadius:"4px",fontSize:"14px",cursor:"pointer"},children:"Limpiar logs"})})]})]})]})}},40361:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},42893:e=>{e.exports=import("react-hot-toast")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},68173:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{config:()=>u,default:()=>c,getServerSideProps:()=>f,getStaticPaths:()=>g,getStaticProps:()=>x,reportWebVitals:()=>m,routeModule:()=>S,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>P,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>h});var s=r(35799),a=r(82755),i=r(28311),d=r(76263),n=r(46157),l=r(34807),p=e([n]);n=(p.then?(await p)():p)[0];let c=(0,i.M)(l,"default"),x=(0,i.M)(l,"getStaticProps"),g=(0,i.M)(l,"getStaticPaths"),f=(0,i.M)(l,"getServerSideProps"),u=(0,i.M)(l,"config"),m=(0,i.M)(l,"reportWebVitals"),h=(0,i.M)(l,"unstable_getStaticProps"),b=(0,i.M)(l,"unstable_getStaticPaths"),y=(0,i.M)(l,"unstable_getStaticParams"),j=(0,i.M)(l,"unstable_getServerProps"),P=(0,i.M)(l,"unstable_getServerSideProps"),S=new s.PagesRouteModule({definition:{kind:a.A.PAGES,page:"/listar-propiedades",pathname:"/listar-propiedades",bundlePath:"",filename:""},components:{App:n.default,Document:d.default},userland:l});o()}catch(e){o(e)}})},74075:e=>{e.exports=require("zlib")},76263:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var o=r(8732),s=r(23267);function a(){return(0,o.jsxs)(s.Html,{lang:"es",children:[(0,o.jsxs)(s.Head,{children:[(0,o.jsx)("meta",{charSet:"utf-8"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),(0,o.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&display=swap",rel:"stylesheet"}),(0,o.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/logo.png"}),(0,o.jsx)("link",{rel:"manifest",href:"/site.webmanifest"})]}),(0,o.jsxs)("body",{children:[(0,o.jsx)(s.Main,{}),(0,o.jsx)(s.NextScript,{})]})]})}},76338:e=>{e.exports=import("js-cookie")},82015:e=>{e.exports=require("react")},82755:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[348,871,267,423],()=>r(68173));module.exports=o})();